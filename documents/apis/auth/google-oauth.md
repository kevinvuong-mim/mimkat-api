# Google OAuth API Documentation

## Overview

API xác thực người dùng thông qua Google OAuth 2.0.

**Base URL**: `/api/v1/auth`

---

## Endpoints

### 1. Initiate Google OAuth (Bắt đầu đăng nhập Google)

Khởi tạo quá trình đăng nhập Google OAuth. Endpoint này sẽ redirect user đến trang đăng nhập của Google.

**Endpoint**: `GET /api/v1/auth/google`

**Authentication**: Không yêu cầu (Public)

#### Response

Endpoint này sẽ redirect user đến Google OAuth consent screen. Không có JSON response.

#### Redirect Flow

1. User được redirect đến `https://accounts.google.com/o/oauth2/v2/api/v1/auth`
2. User chọn tài khoản Google và cấp quyền
3. Google redirect về `/api/v1/auth/google/callback` với authorization code

---

### 2. Google OAuth Callback (Xử lý callback từ Google)

Xử lý callback từ Google sau khi user cấp quyền. Google sẽ tự động redirect đến endpoint này.

**Endpoint**: `GET /api/v1/auth/google/callback`

**Authentication**: Không yêu cầu (Public)

#### Query Parameters (Auto-generated by Google)

| Parameter | Type   | Description                       |
| --------- | ------ | --------------------------------- |
| code      | string | Authorization code từ Google      |
| scope     | string | Các scopes đã được cấp quyền      |
| state     | string | State parameter để verify request |

#### Response

**Success (200 OK)**

```json
{
  "accessToken": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
  "refreshToken": "uuid-refresh-token",
  "user": {
    "id": "uuid",
    "email": "user@gmail.com",
    "emailVerified": true,
    "firstName": "John",
    "lastName": "Doe",
    "avatar": "https://lh3.googleusercontent.com/...",
    "provider": "google",
    "googleId": "google-user-id"
  },
  "isNewUser": false
}
```

| Field              | Type    | Description                                                  |
| ------------------ | ------- | ------------------------------------------------------------ |
| accessToken        | string  | JWT access token để xác thực API requests                    |
| refreshToken       | string  | Refresh token để làm mới access token                        |
| user               | object  | Thông tin người dùng                                         |
| user.id            | string  | User ID trong hệ thống                                       |
| user.email         | string  | Email từ Google account                                      |
| user.emailVerified | boolean | Luôn là `true` với Google OAuth                              |
| user.firstName     | string  | Tên từ Google profile                                        |
| user.lastName      | string  | Họ từ Google profile                                         |
| user.avatar        | string  | URL avatar từ Google                                         |
| user.provider      | string  | "google"                                                     |
| user.googleId      | string  | Google User ID                                               |
| isNewUser          | boolean | `true` nếu là lần đầu đăng nhập, `false` nếu đã có tài khoản |

**Error Responses**

- **401 Unauthorized**: Google authentication failed

```json
{
  "statusCode": 401,
  "message": "Google authentication failed",
  "error": "Unauthorized"
}
```

- **403 Forbidden**: User từ chối cấp quyền

```json
{
  "statusCode": 403,
  "message": "Access denied",
  "error": "Forbidden"
}
```
